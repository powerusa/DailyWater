import Foundation

/// In-app localization helper. Returns translated strings for the given language code.
struct L10n {

    static let supportedLanguages: [(code: String, name: String)] = [
        ("device", "ğŸ“± Device"),
        ("en", "English"),
        ("es", "EspaÃ±ol"),
        ("zh", "ä¸­æ–‡"),
        ("de", "Deutsch"),
        ("pl", "Polski"),
        ("pt", "PortuguÃªs")
    ]

    /// Main translation lookup. Falls back to English if key is missing.
    static func t(_ key: String, _ lang: String) -> String {
        let effective = resolve(lang)
        return translations[effective]?[key] ?? translations["en"]?[key] ?? key
    }

    /// Format a streak string like "5-day streak!"
    static func dayStreak(_ count: Int, _ lang: String) -> String {
        let fmt = t("day_streak_fmt", lang)
        return String(format: fmt, count)
    }

    /// Resolve "device" to a concrete supported language code.
    static func resolve(_ lang: String) -> String {
        if lang != "device" { return lang }
        let preferred = Locale.preferredLanguages.first ?? "en"
        let code = String(preferred.prefix(2))
        return translations.keys.contains(code) ? code : "en"
    }

    // MARK: - Translations

    private static let translations: [String: [String: String]] = [
        "en": en, "es": es, "zh": zh, "de": de, "pl": pl, "pt": pt
    ]

    private static let en: [String: String] = [
        "app_name": "DailyWater",
        "goal_reached": "Goal reached ğŸ‰",
        "set_your_daily_goal": "Set Your Daily Goal",
        "set_goal_prompt": "Tap the gear icon to set a daily water goal and start tracking.",
        "set_goal": "Set Goal",
        "day_streak_fmt": "%d-day streak!",
        "today": "Today",
        "goal": "Goal",
        "remaining": "Remaining",
        "todays_timing": "Today's Timing",
        "morning": "Morning",
        "afternoon": "Afternoon",
        "evening": "Evening",
        "weekly_monthly_charts": "Weekly & Monthly Charts",
        "quick_add": "Quick Add",
        "custom_amount": "Custom Amount",
        "undo": "Undo",
        "reset": "Reset",
        "reset_today": "Reset Today?",
        "reset_today_msg": "This will clear all intake for today.",
        "cancel": "Cancel",
        "settings": "Settings",
        "daily_goal": "Daily Goal",
        "enter_goal": "Enter goal",
        "unit": "Unit",
        "bottle": "ğŸ¶ Bottle",
        "bottle_setup": "Bottle Setup",
        "one_bottle_equals": "1 bottle =",
        "bottle_size": "Size",
        "bottle_hint": "Quick-add shows bottle fractions (Â¼, Â½, Â¾, 1).",
        "appearance": "Appearance",
        "dark_mode": "Dark Mode",
        "language": "Language",
        "save": "Save",
        "history": "History",
        "keep_it_going": "Keep it going!",
        "recent_days": "Recent Days",
        "goal_met": "Goal met",
        "done": "Done",
        "trends": "Trends",
        "seven_days": "7 Days",
        "fourteen_days": "14 Days",
        "thirty_days": "30 Days",
        "average": "Average",
        "goals_met": "Goals Met",
        "streak": "Streak",
        "daily_intake": "Daily Intake",
        "goal_line": "Goal line",
        "back": "Back",
        "bottles": "bottles",
        "goal_colon": "Goal:"
    ]

    private static let es: [String: String] = [
        "app_name": "DailyWater",
        "goal_reached": "Â¡Meta alcanzada ğŸ‰",
        "set_your_daily_goal": "Establece tu meta diaria",
        "set_goal_prompt": "Toca el Ã­cono de engranaje para establecer una meta diaria de agua.",
        "set_goal": "Establecer meta",
        "day_streak_fmt": "Â¡Racha de %d dÃ­as!",
        "today": "Hoy",
        "goal": "Meta",
        "remaining": "Restante",
        "todays_timing": "Horario de hoy",
        "morning": "MaÃ±ana",
        "afternoon": "Tarde",
        "evening": "Noche",
        "weekly_monthly_charts": "GrÃ¡ficos semanales y mensuales",
        "quick_add": "Agregar rÃ¡pido",
        "custom_amount": "Cantidad personalizada",
        "undo": "Deshacer",
        "reset": "Reiniciar",
        "reset_today": "Â¿Reiniciar hoy?",
        "reset_today_msg": "Esto borrarÃ¡ toda la ingesta de hoy.",
        "cancel": "Cancelar",
        "settings": "Ajustes",
        "daily_goal": "Meta diaria",
        "enter_goal": "Ingresa la meta",
        "unit": "Unidad",
        "bottle": "ğŸ¶ Botella",
        "bottle_setup": "ConfiguraciÃ³n de botella",
        "one_bottle_equals": "1 botella =",
        "bottle_size": "TamaÃ±o",
        "bottle_hint": "Agregar rÃ¡pido mostrarÃ¡ fracciones de botella (Â¼, Â½, Â¾, 1).",
        "appearance": "Apariencia",
        "dark_mode": "Modo oscuro",
        "language": "Idioma",
        "save": "Guardar",
        "history": "Historial",
        "keep_it_going": "Â¡Sigue asÃ­!",
        "recent_days": "DÃ­as recientes",
        "goal_met": "Meta cumplida",
        "done": "Listo",
        "trends": "Tendencias",
        "seven_days": "7 dÃ­as",
        "fourteen_days": "14 dÃ­as",
        "thirty_days": "30 dÃ­as",
        "average": "Promedio",
        "goals_met": "Metas cumplidas",
        "streak": "Racha",
        "daily_intake": "Ingesta diaria",
        "goal_line": "LÃ­nea de meta",
        "back": "AtrÃ¡s",
        "bottles": "botellas",
        "goal_colon": "Meta:"
    ]

    private static let zh: [String: String] = [
        "app_name": "DailyWater",
        "goal_reached": "ç›®æ ‡è¾¾æˆ ğŸ‰",
        "set_your_daily_goal": "è®¾å®šæ¯æ—¥ç›®æ ‡",
        "set_goal_prompt": "ç‚¹å‡»é½¿è½®å›¾æ ‡è®¾å®šæ¯æ—¥é¥®æ°´ç›®æ ‡å¹¶å¼€å§‹è®°å½•ã€‚",
        "set_goal": "è®¾å®šç›®æ ‡",
        "day_streak_fmt": "è¿ç»­%då¤©ï¼",
        "today": "ä»Šæ—¥",
        "goal": "ç›®æ ‡",
        "remaining": "å‰©ä½™",
        "todays_timing": "ä»Šæ—¥æ—¶æ®µ",
        "morning": "æ—©æ™¨",
        "afternoon": "ä¸‹åˆ",
        "evening": "æ™šä¸Š",
        "weekly_monthly_charts": "æ¯å‘¨å’Œæ¯æœˆå›¾è¡¨",
        "quick_add": "å¿«é€Ÿæ·»åŠ ",
        "custom_amount": "è‡ªå®šä¹‰é‡",
        "undo": "æ’¤é”€",
        "reset": "é‡ç½®",
        "reset_today": "é‡ç½®ä»Šå¤©ï¼Ÿ",
        "reset_today_msg": "è¿™å°†æ¸…é™¤ä»Šå¤©çš„æ‰€æœ‰æ‘„å…¥è®°å½•ã€‚",
        "cancel": "å–æ¶ˆ",
        "settings": "è®¾ç½®",
        "daily_goal": "æ¯æ—¥ç›®æ ‡",
        "enter_goal": "è¾“å…¥ç›®æ ‡",
        "unit": "å•ä½",
        "bottle": "ğŸ¶ æ°´ç“¶",
        "bottle_setup": "æ°´ç“¶è®¾ç½®",
        "one_bottle_equals": "1ç“¶ =",
        "bottle_size": "å®¹é‡",
        "bottle_hint": "å¿«é€Ÿæ·»åŠ å°†æ˜¾ç¤ºæ°´ç“¶åˆ†æ•°ï¼ˆÂ¼ã€Â½ã€Â¾ã€1ï¼‰ã€‚",
        "appearance": "å¤–è§‚",
        "dark_mode": "æ·±è‰²æ¨¡å¼",
        "language": "è¯­è¨€",
        "save": "ä¿å­˜",
        "history": "å†å²",
        "keep_it_going": "ç»§ç»­ä¿æŒï¼",
        "recent_days": "æœ€è¿‘å‡ å¤©",
        "goal_met": "è¾¾æ ‡",
        "done": "å®Œæˆ",
        "trends": "è¶‹åŠ¿",
        "seven_days": "7å¤©",
        "fourteen_days": "14å¤©",
        "thirty_days": "30å¤©",
        "average": "å¹³å‡",
        "goals_met": "è¾¾æ ‡å¤©æ•°",
        "streak": "è¿ç»­",
        "daily_intake": "æ¯æ—¥æ‘„å…¥",
        "goal_line": "ç›®æ ‡çº¿",
        "back": "è¿”å›",
        "bottles": "ç“¶",
        "goal_colon": "ç›®æ ‡:"
    ]

    private static let de: [String: String] = [
        "app_name": "DailyWater",
        "goal_reached": "Ziel erreicht ğŸ‰",
        "set_your_daily_goal": "Tagesziel festlegen",
        "set_goal_prompt": "Tippe auf das Zahnrad, um ein tÃ¤gliches Wasserziel festzulegen.",
        "set_goal": "Ziel festlegen",
        "day_streak_fmt": "%d-Tage-Serie!",
        "today": "Heute",
        "goal": "Ziel",
        "remaining": "Verbleibend",
        "todays_timing": "Heutiges Timing",
        "morning": "Morgen",
        "afternoon": "Nachmittag",
        "evening": "Abend",
        "weekly_monthly_charts": "Wochen- & Monatsdiagramme",
        "quick_add": "Schnell hinzufÃ¼gen",
        "custom_amount": "Eigene Menge",
        "undo": "RÃ¼ckgÃ¤ngig",
        "reset": "ZurÃ¼cksetzen",
        "reset_today": "Heute zurÃ¼cksetzen?",
        "reset_today_msg": "Alle heutigen EintrÃ¤ge werden gelÃ¶scht.",
        "cancel": "Abbrechen",
        "settings": "Einstellungen",
        "daily_goal": "Tagesziel",
        "enter_goal": "Ziel eingeben",
        "unit": "Einheit",
        "bottle": "ğŸ¶ Flasche",
        "bottle_setup": "Flascheneinstellung",
        "one_bottle_equals": "1 Flasche =",
        "bottle_size": "GrÃ¶ÃŸe",
        "bottle_hint": "Schnell hinzufÃ¼gen zeigt Flaschenbruchteile (Â¼, Â½, Â¾, 1).",
        "appearance": "Darstellung",
        "dark_mode": "Dunkelmodus",
        "language": "Sprache",
        "save": "Speichern",
        "history": "Verlauf",
        "keep_it_going": "Weiter so!",
        "recent_days": "Letzte Tage",
        "goal_met": "Ziel erreicht",
        "done": "Fertig",
        "trends": "Trends",
        "seven_days": "7 Tage",
        "fourteen_days": "14 Tage",
        "thirty_days": "30 Tage",
        "average": "Durchschnitt",
        "goals_met": "Ziele erreicht",
        "streak": "Serie",
        "daily_intake": "TÃ¤gliche Aufnahme",
        "goal_line": "Ziellinie",
        "back": "ZurÃ¼ck",
        "bottles": "Flaschen",
        "goal_colon": "Ziel:"
    ]

    private static let pl: [String: String] = [
        "app_name": "DailyWater",
        "goal_reached": "Cel osiÄ…gniÄ™ty ğŸ‰",
        "set_your_daily_goal": "Ustaw dzienny cel",
        "set_goal_prompt": "Stuknij ikonÄ™ koÅ‚a zÄ™batego, aby ustawiÄ‡ dzienny cel nawodnienia.",
        "set_goal": "Ustaw cel",
        "day_streak_fmt": "Seria %d dni!",
        "today": "DziÅ›",
        "goal": "Cel",
        "remaining": "PozostaÅ‚o",
        "todays_timing": "Dzisiejszy rozkÅ‚ad",
        "morning": "Rano",
        "afternoon": "PopoÅ‚udnie",
        "evening": "WieczÃ³r",
        "weekly_monthly_charts": "Wykresy tygodniowe i miesiÄ™czne",
        "quick_add": "Szybkie dodawanie",
        "custom_amount": "WÅ‚asna iloÅ›Ä‡",
        "undo": "Cofnij",
        "reset": "Resetuj",
        "reset_today": "ZresetowaÄ‡ dzisiaj?",
        "reset_today_msg": "To usunie caÅ‚e dzisiejsze spoÅ¼ycie.",
        "cancel": "Anuluj",
        "settings": "Ustawienia",
        "daily_goal": "Dzienny cel",
        "enter_goal": "Wpisz cel",
        "unit": "Jednostka",
        "bottle": "ğŸ¶ Butelka",
        "bottle_setup": "Ustawienia butelki",
        "one_bottle_equals": "1 butelka =",
        "bottle_size": "Rozmiar",
        "bottle_hint": "Szybkie dodawanie pokaÅ¼e uÅ‚amki butelki (Â¼, Â½, Â¾, 1).",
        "appearance": "WyglÄ…d",
        "dark_mode": "Tryb ciemny",
        "language": "JÄ™zyk",
        "save": "Zapisz",
        "history": "Historia",
        "keep_it_going": "Tak trzymaj!",
        "recent_days": "Ostatnie dni",
        "goal_met": "Cel osiÄ…gniÄ™ty",
        "done": "Gotowe",
        "trends": "Trendy",
        "seven_days": "7 dni",
        "fourteen_days": "14 dni",
        "thirty_days": "30 dni",
        "average": "Åšrednia",
        "goals_met": "OsiÄ…gniÄ™te cele",
        "streak": "Seria",
        "daily_intake": "Dzienne spoÅ¼ycie",
        "goal_line": "Linia celu",
        "back": "Wstecz",
        "bottles": "butelki",
        "goal_colon": "Cel:"
    ]

    private static let pt: [String: String] = [
        "app_name": "DailyWater",
        "goal_reached": "Meta atingida ğŸ‰",
        "set_your_daily_goal": "Defina sua meta diÃ¡ria",
        "set_goal_prompt": "Toque no Ã­cone de engrenagem para definir uma meta diÃ¡ria de Ã¡gua.",
        "set_goal": "Definir meta",
        "day_streak_fmt": "SequÃªncia de %d dias!",
        "today": "Hoje",
        "goal": "Meta",
        "remaining": "Restante",
        "todays_timing": "HorÃ¡rio de hoje",
        "morning": "ManhÃ£",
        "afternoon": "Tarde",
        "evening": "Noite",
        "weekly_monthly_charts": "GrÃ¡ficos semanais e mensais",
        "quick_add": "Adicionar rÃ¡pido",
        "custom_amount": "Quantidade personalizada",
        "undo": "Desfazer",
        "reset": "Redefinir",
        "reset_today": "Redefinir hoje?",
        "reset_today_msg": "Isso limparÃ¡ toda a ingestÃ£o de hoje.",
        "cancel": "Cancelar",
        "settings": "ConfiguraÃ§Ãµes",
        "daily_goal": "Meta diÃ¡ria",
        "enter_goal": "Insira a meta",
        "unit": "Unidade",
        "bottle": "ğŸ¶ Garrafa",
        "bottle_setup": "ConfiguraÃ§Ã£o da garrafa",
        "one_bottle_equals": "1 garrafa =",
        "bottle_size": "Tamanho",
        "bottle_hint": "Adicionar rÃ¡pido mostrarÃ¡ fraÃ§Ãµes da garrafa (Â¼, Â½, Â¾, 1).",
        "appearance": "AparÃªncia",
        "dark_mode": "Modo escuro",
        "language": "Idioma",
        "save": "Salvar",
        "history": "HistÃ³rico",
        "keep_it_going": "Continue assim!",
        "recent_days": "Dias recentes",
        "goal_met": "Meta atingida",
        "done": "ConcluÃ­do",
        "trends": "TendÃªncias",
        "seven_days": "7 dias",
        "fourteen_days": "14 dias",
        "thirty_days": "30 dias",
        "average": "MÃ©dia",
        "goals_met": "Metas atingidas",
        "streak": "SequÃªncia",
        "daily_intake": "IngestÃ£o diÃ¡ria",
        "goal_line": "Linha da meta",
        "back": "Voltar",
        "bottles": "garrafas",
        "goal_colon": "Meta:"
    ]
}
